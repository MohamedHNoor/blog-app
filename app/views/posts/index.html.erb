<h1>List of posts for a given user</h1>

<div class="d-flex align-items-center mb-3 gap-3 text-secondary-emphasis w-100">
  <div>
    <img src="<%= @user.photo %>" alt="user photo" class= "border border-5 p-5">
  </div>
  <div class=" border border-5 w-100 p-3">
    <h2 class="flex-grow-1 p-2"> <%= @user.name %></h2>
    <div class="d-flex justify-content-end">
      <p>Number of posts: <%= @user.posts_counter %></p>
    </div>
  </div>
</div>

<section>
  <% @user.most_recent_posts.each do |post| %>
      <div class="border border-5 mx-auto w-100 p-3 mb-3">
        <h3><%= link_to post.title, "/users/#{@user.id}/posts/#{post.id}" %></h3>
        <p><%= post.text %></p>

        <div class="d-flex justify-content-between">
          <div>
            <%= form_with url: "/likes/#{post.id}" do |form| %>
              <%= form.submit "Like", class: "btn btn-outline-secondary"%>
            <% end %>
          </div>

          <div>
            <span>Comments: <%= "#{post.comments_counter || 0 }"%></span>
          <span>, Likes: <%= "#{post.likes_counter || 0 }"%></span>
          </div>

        </div>
      </div>

    <div class="border border-5 mx-auto w-100 p-3 mb-3">
    <% if post.most_recent_comments.length > 0 %>
      <% post.most_recent_comments.each do |comment| %>
          <span><%= comment.author.name %>:</span>
          <span> <%= comment.text %></span>
      <% end %>
      <% else %> 
        <p>
          No comments yet
        </p>
      <% end %>
    </div>

    <div>
      <%= form_with url: "/comments/#{post.id}" do |form| %>
        <div>
          <%= form.text_area :text, placeholder: "Add comment", class: "form-control"%>
        </div>
        <%= form.submit "Add Comment", class: "btn btn-outline-secondary m-2" %>
      <% end %>
    </div>
    
  <% end %>
</section>

<div class="text-center mb-3">
  <a href="/posts/new" class="btn btn-outline-secondary">Create new post</a>
</div>




